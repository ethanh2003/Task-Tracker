<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Tracker</title>
    <link rel="stylesheet" href="../static/main.css">
</head>
<body>
<div class="top-contain">
    <a href="/logout">
        <button class="top-bar">Log Out</button>
    </a>
    <a href="/task">
        <button class="top-bar">Task</button>
    </a>
    {% if user.access==1 %}
        <a href="/ViewUsers">
            <button class="top-bar">User Management</button>
        </a>{% endif %}
</div>
    <div id="todo" class="todo">
        <table>
            <thead>
            <th>Title</th>
            <th>Description</th>
            <th>Due Date</th>
            <th>Assigned To</th>
            <th>Status</th>
            <th></th>
            <th></th>
            </thead>
            <tbody>
                <tr>

                        <td class="title"><a href="/viewTask/{{ todo.id }}">{{ todo.title }}</a></td>
                        <td>{{ todo.description }}</td>
                        <td>{{ todo.due }}</td>
                        <td>{{ todo.assigned }}</td>
                        <td>{% if todo.complete == 0 %}
                            <button class="notStarted">Not Started</button>
                        {% elif todo.complete == 1 %}
                            <button class="inProgress">In Progress</button>
                        {% else %}
                            <button class="complete">Complete</button>
                        {% endif %}</td>
                        <td><a href="/update/{{ todo.id }}">
                            <button>Update</button>
                        </a></td>
                        {% if todo.createdBy == user.id or user.access == 1 %}
                            <td><a href="/editTask/{{ todo.id }}">
                                <button>Edit</button>
                            </a></td>
                            <td><a href="/delete/{{ todo.id }}">
                                <button>Delete</button>
                            </a></td>
                        {% endif %}</tr>
            </tbody>
        </table>
    </div>
    {% if todo.comments %}
  {% if todo.comments|length > 0 %}
    <h2>Comments</h2>
    <ul>
    {% for comment in todo.comments %}
      <li>{{ comment.content }}</li>
    {% endfor %}
    </ul>
  {% endif %}
{% endif %}
<form action="{{ url_for('new_comment', task_id=todo.id) }}" method="post">
  <div>
    <h2 >Add a comment</h2>
    <div >
      {{ form.comment.label }} <br/> {{ form.comment }}
    </div>
    {{ form.submit }}
  </div>
</form>
</body>
</html>